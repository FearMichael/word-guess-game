<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Word Guess</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" media="screen" href="style.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    
</head>
<body>
    <!-- Audio files -->
    <audio id="lossSound">
        <source src="michael-scott-no.mp3" type="audio/mp3">
    </audio>
    <audio id="winSound">
            <source src="dwight-promotion.mp3" type="audio/mp3">
        </audio>
<!-- Background setup -->
<div class="background-overlay"></div>  
<!-- Title Header  -->
<header class="container text-center mt-4">
    <h1 class="text-white">Photographer's Word Guess</h1>
</header>

<!-- <div class="text-center mt-5">
    <h2 class="text-white" id="pressKey">Press any key to play!</h2>
</div> -->
<!-- Answer area -->
<div class="container text-center text-white my-4">
    <h2 id="answer"></h2>
</div>
<!-- Guess area -->
<div class="row">
    <div class="container col-4 text-white text-center">
            <h3>Wins:</h3>
            <h3 id="wins"></h3>
    </div> 
    <div class="col-4 container text-center text-white my-4" id="guess-box">
        <h4>Guesses:</h4>
        <h5 id="guesses"></h5>
        <h4>Remaining:</h4>
        <h5 id="guessesLeft"></h5>
    </div>
        
    <div class="container col-4 text-white text-center">
        <h3>Losses:</h3>
        <h3 id="losses"></h3>
    </div>
</div>
<!-- visible at game end -->
<div class="container" id="winner">
    <h1 class="text-center text-white">CONGRATS! YOU WON!</h1>
    <h3 class="text-center text-white">Play Again?</h3>
</div>
<div class="container" id="loser">
        <h1 class="text-center text-white">Oh No... You Lost!</h1>
        <h2 class="text-center text-white">The word was<span id="word"></span></h2>
        <h3 class="text-center text-white">Try Again?</h3>
    </div>
<div class="container text-center mt-3 p-3">
    <button class="btn btn-lg btn-success play-bg p-3" id="play">PLAY!</button>
</div>
<!-- Footer and photo cred -->
<div class="container fixed-bottom text-center text-light">
    <p>Background image thanks to: Photo by William Bayreuther on Unsplash</p>
</div>
<script>
//Word Guess Game Logic
const wordGuessGame = {
    //Array of words to choose from
    words: ["camera","lens","shutter","canon","nikon","panasonic","aperature","aspect ratio","bokeh","film","focal length","flash","exposure","manual","metering","noise","raw","negative","print","portrait","red eye","zoom","telephoto","full frame","stabilizer"],
    // Random Number generated and assigned to pick a word from the word array
    generateWord: function() {
        return this.words[Math.floor(Math.random() * this.words.length -1)];
    },    
    guesses: [],
    playButton: $("#play"),
}

// Declare variables
let word = "focal length"
var maskWord;
var answer = $("#answer");
var losses = 0;
var wins = 0;
var guessCount;
var lossSound = $("#lossSound")[0];
var winSound = $("#winSound")[0];

//Game start logic
wordGuessGame.playButton.on('click', function() {
   answer.text("");
   $("#guesses").text("");
   $("#guessesLeft").text("");
   maskWord = [];
    // word = wordGuessGame.generateWord(); BUG TESTING - REACTIVATE
    for (i = 0; i < word.length; i++) {
            if (word[i] === " ") {
            maskWord[i] = " ";
            } else if (word[i] !== " ") {
            maskWord[i] = "_";
            }
            };
            // document.getElementById("answer").textContent = maskWord.join('');
            answer.text(maskWord.join(" "));
    wordGuessGame.playButton.hide(800);
    wordGuessGame.guesses = [];
    $("#guess-box").show();
    $("#winner").hide();
    $("#loser").hide();
    guessCount = word.length + 3;
    $("#guessesLeft").text(guessCount);
    console.log(word);
});
//Game End logic
var gameEnd = () => {
    if (wordGuessGame.guesses.length === word.length + 3) {
        $("#loser").show(800);
        $("#play").show();
        losses++;
        $("#losses").text(losses);
        lossSound.play();
        $("#word").html("&nbsp;" + word);
        }
       
    if (maskWord.join('') == word) {
        $("#winner").show(800);
        $("#play").show();
        wins++;
        $("#wins").text(wins);
        $("body").hide(001);
        $("body").show(001);
        winSound.play();
    }
    };
    document.onkeypress = function(event) {
        return false;
    };
// Keystroke and guess recognition
document.onkeypress = function(event) {
        var keyGuess = event.key;
            console.log(keyGuess);
            if (word.indexOf(keyGuess) === -1 && wordGuessGame.guesses.includes(keyGuess) == false) {
                console.log(word.indexOf(keyGuess));
                wordGuessGame.guesses.push(keyGuess);
                $("#guesses").append(" " + keyGuess + " ");
                guessCount -= 1;
            } else {
                for (i=0; i<word.length; i++) {
                    if (word[i] == keyGuess) {
                        maskWord[i] = keyGuess;
                        answer.text(maskWord.join(' '));

                    }
                }
            };
        gameEnd();

        $("#guessesLeft").text(guessCount);
};

</script>
</body>
</html>